📅 lubridate 包速查笔记
R 语言中处理日期/时间的高效工具包（tidyverse 生态），简化日期转换、提取、运算等操作。

🔧 安装与加载
# 安装（仅首次需要）
install.packages("lubridate")

# 加载包
library(lubridate)

🚀 核心功能
1. 日期/时间转换（最常用）
按「年/月/日」顺序命名，自动识别多种分隔符（- / / . / 无分隔符），无需手动指定 format。

函数         含义                 示例代码                                  输出结果
---------    -------------------- ---------------------------------------  ------------------------
ymd()        年-月-日             ymd("2026/01/20")                       2026-01-20
mdy()        月-日-年             mdy("01/20/2026")                       2026-01-20
dmy()        日-月-年             dmy("20.01.2026")                       2026-01-20
ymd_hms()    年-月-日 时:分:秒    ymd_hms("20260120 14:30:45")            2026-01-20 14:30:45
ymd_hm()     年-月-日 时:分       ymd_hm("2026-01-20 14:30")              2026-01-20 14:30:00

2. 提取日期/时间组件
从日期/时间对象中提取指定维度的信息，函数名语义化，易记易用。

# 示例日期时间
dt <- ymd_hms("2026-01-20 14:30:45")

# 提取核心组件
year(dt)   # 提取年 → 2026
month(dt)  # 提取月 → 1
day(dt)    # 提取日 → 20
hour(dt)   # 提取小时 → 14
minute(dt) # 提取分钟 → 30
second(dt) # 提取秒 → 45

# 提取星期（扩展）
wday(dt)                # 数字型星期（1=周日，7=周六）→ 3（周二）
wday(dt, label = TRUE)  # 星期标签 → Tue
month(dt, label = TRUE) # 月份标签 → Jan

3. 日期/时间运算
支持直观的时间加减，搭配 days()/months()/years() 等函数使用。

# 基础日期
dt <- ymd("2026-01-20")

# 时间加减
dt + days(5)           # 加5天 → 2026-01-25
dt - months(2)         # 减2个月 → 2025-11-20
dt + years(1)          # 加1年 → 2027-01-20
dt + hours(3) + minutes(15) # 加3小时15分钟 → 2026-01-20 03:15:00

# 计算时间差
start <- ymd("2026-01-01")
end <- ymd("2026-01-20")
as.duration(end - start) # 时长差 → 19d 0H 0M 0S
difftime(end, start, units = "days") # 天数差 → 19 days

4. 实用工具函数
# 获取当前时间
today()  # 当前日期（无时间）→ 2026-01-21
now()    # 当前日期+时间 → 2026-01-21 10:00:00（示例）

# 时区操作
dt <- now()
tz(dt) # 查看当前时区 → 例如 "Asia/Shanghai"
with_tz(dt, "America/New_York") # 转换为纽约时区

🎯 核心优势
1. 无需记忆繁琐的 format 格式符（如 %Y/%m/%d），自动适配多种日期格式；
2. 函数名语义化（如 ymd = 年-月-日），新手易上手；
3. 完美兼容 tidyverse 生态（dplyr、ggplot2 等）。

📌 注意事项
- ymd() 强制「年-月-日」顺序，若日期是「月-日-年」需用 mdy()，「日-月-年」用 dmy()；
- 处理带时区的时间时，建议先统一时区再进行运算。